From b0c9a4efe2d28d17074dc74a988080a4d13046bd Mon Sep 17 00:00:00 2001
From: Tommy Lin <lin.tommysc@inventec.com>
Date: Fri, 16 Sep 2022 01:01:58 +0000
Subject: [PATCH 27/27] Postpone MS Subsystem health check

Symptom/Reason:
- SEL id skipped after PDU off/on

Root Cause:
- rsyslog skipped journal log when detecting timestamp backward

Solution/Change:
- [phosphor-sel-logger]
  - Undo patch of Bug651
  - Reset recordIndex when SEL clear
- [dbus-sensors]
  - Set ms_subsystem_check service launch after xyz.openbmc_project.Time.Manager
- [transformers-init]
  - Set watchdog service launch after xyz.openbmc_project.Time.Manager
---
 service_files/xyz.openbmc_project.ms_subsystem_check.service | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/service_files/xyz.openbmc_project.ms_subsystem_check.service b/service_files/xyz.openbmc_project.ms_subsystem_check.service
index 98a4bf7..39bdca1 100644
--- a/service_files/xyz.openbmc_project.ms_subsystem_check.service
+++ b/service_files/xyz.openbmc_project.ms_subsystem_check.service
@@ -1,6 +1,8 @@
 [Unit]
 Description=MS Subsystem health check
 StopWhenUnneeded=false
+Requisite=xyz.openbmc_project.Time.Manager.service
+After=xyz.openbmc_project.Time.Manager.service
 
 [Service]
 Restart=always
-- 
2.33.0

